var AnalyticsCoreBundle=function(e){"use strict";const t=globalThis.METRICS||{};function a(e,t,a=0){const n=Number(e)||0,l=Number(t);return Number.isFinite(l)&&0!==l?n/l:a}function n(e){if(null==e)return 0;if("number"==typeof e)return e;const t=String(e).replace(/,/g,""),a=Number(t);return Number.isFinite(a)?a:0}function l(e,t,a){return Math.max(t,Math.min(a,e))}function i(e,t,a,n=0,i=100){if(!Number.isFinite(e))return(n+i)/2;if(a===t)return n;return l((e-t)/(a-t)*(i-n)+n,n,i)}function r(e,t=0,a=100){return i(e,t,a,0,100)}function o(e,t=-1,a=1){return i(e,t,a,-100,100)}function c(e){if(!e||0===e.length)return{mean:0,std:0};const t=e.filter(e=>Number.isFinite(e));if(0===t.length)return{mean:0,std:0};const a=t.reduce((e,t)=>e+t,0)/t.length,n=t.reduce((e,t)=>e+Math.pow(t-a,2),0)/t.length;return{mean:a,std:Math.sqrt(n)}}function s(e,t,a){return Number.isFinite(a)&&0!==a?(e-t)/a:0}function u(e,t,a,n=0){if(!Number.isFinite(a)||0===a)return n;const l=Number(e),i=Number(t);return Number.isFinite(l)&&Number.isFinite(i)?(l-i)/a:n}function h(e,t){if(!e||0===e.length)return 0;const a=[...e].sort((e,t)=>e-t),n=Math.floor(t/100*a.length);return a[Math.min(n,a.length-1)]}function m(e,t=14){if(!e||e.length<2)return 0;const l=[];for(let t=1;t<e.length;t++){const a=e[t],i=e[t-1],r=n(a.high)||n(a.last),o=n(a.low)||n(a.last),c=n(i.last)||n(i.close),s=Math.max(r-o,Math.abs(r-c),Math.abs(o-c));l.push(s)}if(0===l.length)return 0;const i=Math.min(t,l.length);return a(l.slice(-i).reduce((e,t)=>e+t,0),i,0)}function d(e,t){const a=n(e),l=n(t);return l>0?a/l*100:a>0?null:0}function f(e,t,a=50){const i=n(e)+n(t);return i<=0?a:l(n(e)/i*100,0,100)}function v(e,t={}){const a=t.lookbackPeriods||20,l=t.minSamples||10,i=t.smoothingWindow||5;if(!e||e.length<l)return{valid:!1,reason:"INSUFFICIENT_DATA"};const o=e.slice(-a),c=[];for(let e=1;e<o.length;e++){const t=o[e-1],a=o[e],l=n(t.price)||n(t.last)||0,i=n(a.price)||n(a.last)||0,r=(n(t.volBuy2h)||0)+(n(t.volSell2h)||0)||n(t.vol)||0,s=i-l,u=((n(a.volBuy2h)||0)+(n(a.volSell2h)||0)||n(a.vol)||0)-r;0!==u&&c.push(s/u)}if(c.length<l)return{valid:!1,reason:"INSUFFICIENT_SAMPLES"};const s=c.reduce((e,t)=>e+t,0)/c.length,u=Math.min(i,c.length),h=c.slice(-u),m=h.reduce((e,t)=>e+t,0)/h.length,d=Math.abs(m);return{valid:!0,value:m,rawMean:s,normalized:r(Math.min(1e3*d,100),0,100),interpretation:d>.01?"ILLiquid":d>.001?"MODERATE_LIQUID":"LIQUID",className:d>.01?"text-danger":d>.001?"text-warning":"text-success"}}function y(e,t={}){const a=t.lookbackPeriods||120,i="number"==typeof t.stdMultiplier?t.stdMultiplier:2,r=!!t.adaptiveMultiplier,o=t.minMultiplier||1.5,c=t.maxMultiplier||3;if(!e||!e.length)return{valid:!1,reason:"INSUFFICIENT_DATA"};const s=e.slice(-a);let u=0,h=0;const m=[];for(const e of s){const t=n(e.price)||n(e.last)||0,a=(n(e.volBuy2h)||0)+(n(e.volSell2h)||0)||n(e.vol)||0||0;t&&a&&(u+=t*a,h+=a),t&&m.push({price:t,vol:a})}const d=h>0?u/h:m.length?m[m.length-1].price:0;let f=0;for(const e of m)f+=e.vol*Math.pow(e.price-d,2);const v=h>0?Math.sqrt(f/h):0;let y=i;if(r&&v>0&&d>0){y=l(i*(1+5*(v/Math.max(1e-8,d))),o,c)}const M=d+y*v,p=d-y*v,N=0===d?"N/A":m.length&&m[m.length-1].price>M?"ABOVE_VWAP":m.length&&m[m.length-1].price<p?"BELOW_VWAP":"AT_VWAP",g=d>0?(m.length?m[m.length-1].price-d:0)/d*100:0,b="ABOVE_VWAP"===N&&Math.abs(g)>v/d*100?"OVERBOUGHT_WARNING":"BELOW_VWAP"===N?"OVERSOLD":"NONE";return{valid:!0,vwap:d,upperBand:M,lowerBand:p,std:v,multiplier:y,currentPosition:N,deviationPct:g,signal:b,className:"OVERBOUGHT_WARNING"===b?"text-danger":"OVERSOLD"===b?"text-success":"text-muted"}}function M(e,t={}){const a=t.window||"all",l=t.normalizationMethod||"total";if(t.smoothingPeriod,!e||!e.length)return{valid:!1,reason:"INSUFFICIENT_DATA"};const i=e.slice(-("all"===a?e.length:a));let r=0,o=0;for(const e of i){const t=n(e.volBuy2h)||n(e.buy)||n(e.vol_buy)||0,a=n(e.volSell2h)||n(e.sell)||n(e.vol_sell)||0;r+=t-a,o+=Math.abs(t)+Math.abs(a)}let c=r;"total"===l&&o>0&&(c=r/o);const s=Math.abs(c);let u="NEUTRAL";s>.05&&(u=c>0?"ACCUMULATION":"DISTRIBUTION");return{valid:!0,value:r,normalized:c,trend:u,strength:s>.2?"STRONG":s>.08?"MODERATE":"WEAK",className:"ACCUMULATION"===u?"text-success":"DISTRIBUTION"===u?"text-danger":"text-muted"}}function p(e,t={}){const a=t.baselinePeriods||14,l=t.minSamplesRequired||10;if(!e||e.length<l)return{valid:!1,reason:"INSUFFICIENT_DATA"};const i=e.slice(-Math.max(a,1)-1),r=[];for(const e of i.slice(0,-1)){const t=(n(e.volBuy2h)||0)+(n(e.volSell2h)||0)||n(e.vol)||0;r.push(Math.max(t,1))}const o=r.length?r.reduce((e,t)=>e+t,0)/r.length:1,c=i.length?i[i.length-1]:null,s=c&&((n(c.volBuy2h)||0)+(n(c.volSell2h)||0)||n(c.vol))||0,u=o>0?s/o:null;let h="NONE";return h=!u||u<1.2?"LOW":u<2?"MODERATE":"HIGH",{valid:!0,value:u,baseline:o,current:s,significance:h,className:"HIGH"===h?"text-warning fw-bold":"MODERATE"===h?"text-warning":"text-muted"}}function N(e,t={}){const a=e&&"object"==typeof e?Number(e.value)||0:Number(e||0),n=Math.abs(a),l=t.max||.02,i=r(Math.min(n,l),0,l);return Math.round(i)}function g(e,t={}){if(!e||"object"!=typeof e)return 50;const a=Number(e.deviationPct)||0,n=t.minPercent||-5,l=t.maxPercent||5;return Math.round(r(a,n,l))}function b(e,t={}){const a=e&&"object"==typeof e&&Number.isFinite(Number(e.normalized))?Number(e.normalized):Number(e)||0;return Math.round(r(a,-1,1))}function A(e,t={}){const a=e&&"object"==typeof e&&Number.isFinite(Number(e.value))?Number(e.value):Number(e)||0,n=t.max||3;return Math.round(r(a,0,n))}function I(e,a={}){const n=(t&&t.WEIGHTS&&t.WEIGHTS.TIER1?t.WEIGHTS.TIER1:null)||{kyle:.3,vwap:.25,cvd:.25,rvol:.2},l=N(e.kyleLambda,a.kyle),i=g(e.vwapBands,a.vwap),r=b(e.cvd,a.cvd),o=A(e.rvol,a.rvol);return{kyle:l,vwap:i,cvd:r,rvol:o,tier1Score:Math.round(l*n.kyle+i*n.vwap+r*n.cvd+o*n.rvol)}}function E(e,t={}){const a=t.lookbackBars||50,l=t.minSamples||10;if(!Array.isArray(e)||e.length<l)return{valid:!1,reason:"INSUFFICIENT_DATA"};const i=e.slice(-a),o=[];for(const e of i){const t=n(e.volBuy)||n(e.volBuy2h)||n(e.vol_buy)||0,a=n(e.volSell)||n(e.volSell2h)||n(e.vol_sell)||0,l=t+a;if(l<=0)continue;const i=(t-a)/l;o.push(Math.abs(i))}if(!o.length)return{valid:!1,reason:"NO_VOLUME"};const c=o.reduce((e,t)=>e+t,0)/o.length;return{valid:!0,value:c,percent:100*c,normalized:Math.round(r(c,0,1))}}function _(e,t={}){const a=t.minSamples||50;if(!Array.isArray(e)||e.length<a)return{valid:!1,reason:"INSUFFICIENT_DATA"};const l=e.map(e=>n(e.price)||n(e.last)||0).filter(e=>Number.isFinite(e)&&e>0);if(l.length<a)return{valid:!1,reason:"INSUFFICIENT_PRICES"};const i=l.length,o=Math.floor(i/2),c=[],s=[];for(let e=10;e<=Math.min(100,o);e=Math.floor(1.5*e)){const t=Math.floor(i/e);if(t<2)continue;let a=0;for(let n=0;n<t;n++){const t=l.slice(n*e,(n+1)*e),i=t.reduce((e,t)=>e+t,0)/t.length,r=t.map(e=>e-i),o=[];let c=0;for(const e of r)c+=e,o.push(c);a+=(Math.max(...o)-Math.min(...o))/(Math.sqrt(t.reduce((e,t)=>e+Math.pow(t-i,2),0)/t.length)||1e-8)}const n=a/t;c.push(Math.log(e)),s.push(Math.log(n))}if(c.length<2)return{valid:!1,reason:"INSUFFICIENT_SCALING"};const u=c.length,h=c.reduce((e,t)=>e+t,0)/u,m=s.reduce((e,t)=>e+t,0)/u;let d=0,f=0;for(let e=0;e<u;e++)d+=(c[e]-h)*(s[e]-m),f+=Math.pow(c[e]-h,2);let v=0===f?0:d/f;(!Number.isFinite(v)||v<=0)&&(v=0),v=Math.max(0,Math.min(1,v));return{valid:!0,value:v,interpretation:v>.55?"TRENDING":v<.45?"MEAN_REVERTING":"RANDOM",normalized:Math.round(r(v,0,1))}}function S(e,t={}){const a=t.bins||20;if(!Array.isArray(e)||0===e.length)return{valid:!1,reason:"INSUFFICIENT_DATA"};const l=e.map(e=>n(e.price)||n(e.last)||0).filter(e=>Number.isFinite(e)),i=e.map(e=>(n(e.volBuy)||n(e.volBuy2h)||0)+(n(e.volSell)||n(e.volSell2h)||0)||n(e.vol)||0),r=Math.min(...l),o=Math.max(...l);if(r===o)return{valid:!1,reason:"FLAT_PRICE"};const c=(o-r)/a,s=new Array(a).fill(0);for(let e=0;e<l.length;e++){const t=l[e],n=i[e]||0;s[Math.min(a-1,Math.max(0,Math.floor((t-r)/c)))]+=n}let u=0,h=0,m=0;for(let e=0;e<s.length;e++)m+=s[e],s[e]>h&&(h=s[e],u=e);const d=r+(u+.5)*c,f=.7*m;let v=s[u],y=u,M=u;for(;v<f&&(y>0||M<a-1);){const e=y>0?s[y-1]:-1,t=M<a-1?s[M+1]:-1;if(e>=t)if(e>0)y-=1,v+=s[y];else{if(!(t>0))break;M+=1,v+=s[M]}else if(t>0)M+=1,v+=s[M];else{if(!(e>0))break;y-=1,v+=s[y]}}return{valid:!0,poc:d,valueAreaLow:r+y*c,valueAreaHigh:r+(M+1)*c,profile:s,totalVolume:m}}function x(e,t={}){if(!e)return{valid:!1,reason:"NO_SNAPSHOT"};const a=n(e.bidDepth)||n(e.bid_size)||n(e.bids_size)||0,l=n(e.askDepth)||n(e.ask_size)||n(e.asks_size)||0,i=a+l;if(0===i)return{valid:!1,reason:"NO_DEPTH"};const o=(a-l)/i;return{valid:!0,value:o,normalized:Math.round(r(o,-1,1)),className:o>0?"text-success":"text-danger"}}function T(e){const t=e&&(e.analytics||e._analytics)?e.analytics||e._analytics:e||{},i=n(t.volBuy2h)+n(t.volSell2h),o=n(t.freqBuy2h)+n(t.freqSell2h);if(0===o){const e=.5*(n(t.volBuy_vs_avg_percent)||100)+.5*(n(t.volDurability2h_percent)||50);return{value:l(e,0,200),normalized:r(e,0,200),interpretation:e>150?"WHALE":e>100?"MIXED":e>50?"RETAIL":"LOW",className:e>150?"text-success fw-bold":e>100?"text-warning":"text-muted"}}const c=a(i,o,0),s=a(n(t.avgBuy2h)+n(t.avgSell2h),n(t.avgFreqBuy2h)+n(t.avgFreqSell2h),c),u=100*a(c,s,1);return{value:l(u,0,500),normalized:r(u,0,200),interpretation:u>150?"WHALE":u>100?"MIXED":u>50?"RETAIL":"LOW",className:u>150?"text-success fw-bold":u>100?"text-warning":"text-muted"}}function D(e){const t=e&&(e.analytics||e._analytics)?e.analytics||e._analytics:e||{},i=n(t.volBuy2h),o=n(t.volSell2h),c=Math.max(n(t.avgBuy2h),1),s=Math.max(n(t.avgSell2h),1),u=n(t.freqBuy2h),h=n(t.freqSell2h),m=n(t.avgFreqBuy2h),d=n(t.avgFreqSell2h),f=(a(i,c,1)+a(o,s,1))/2;let v=1;(m>0||d>0)&&(v=(a(u,Math.max(m,1),1)+a(h,Math.max(d,1),1))/2);const y=(f+v)/2*50;return{value:l(y,0,200),normalized:r(y,0,150),level:y>100?"EXTREME":y>70?"HIGH":y>40?"MEDIUM":"LOW",className:y>70?"text-success fw-bold":y>40?"text-warning":"text-muted"}}function L(e){const t=e&&(e.analytics||e._analytics)?e.analytics||e._analytics:e||{},a=n(t.volDurability2h_percent)||50,i=n(t.volDurability24h_percent)||50,r=50+25*((a-50)/50)+15*l(((n(t.volBuy_vs_avg_percent)||100)-100)/100,-1,1)+10*(Math.abs(i-50)>10&&Math.sign(i-50)===Math.sign(a-50)?1:.5);return{value:l(r,0,100),normalized:l(r,0,100),interpretation:r>70?"ACCUMULATION":r<30?"DISTRIBUTION":"NEUTRAL",className:r>70?"text-success":r<30?"text-danger":"text-warning"}}function R(e){const t=e&&(e.analytics||e._analytics)?e.analytics||e._analytics:e||{},a=n(e.percent_change),l=((n(t.volDurability2h_percent)||50)-50)/50,i=l-.5*(a>.5?1:a<-.5?-1:0);let r="NEUTRAL",c="text-muted";return i>.3&&a<0?(r="BULL DIV",c="text-success fw-bold"):i<-.3&&a>0?(r="BEAR DIV",c="text-danger fw-bold"):i>.2?(r="BULLISH",c="text-success"):i<-.2&&(r="BEARISH",c="text-danger"),{value:i,normalized:o(i,-1,1),interpretation:r,priceChange:a,flowBias:l,className:c}}function O(e){const t=e&&(e.analytics||e._analytics)?e.analytics||e._analytics:e||{},a=T(e),i=n(t.volBuy_vs_avg_percent)||100,o=n(t.volDurability2h_percent)||50;let c=0;return c+=.4*r(a.value,50,200),c+=.35*r(i,50,300),c+=.5*Math.abs(o-50),{value:l(c,0,100),normalized:l(c,0,100),level:c>70?"HIGH":c>40?"MEDIUM":"LOW",className:c>70?"text-info fw-bold":c>40?"text-info":"text-muted"}}function B(e){const t=D(e),n=O(e),i=l(t.value>0?100*a(n.value,t.value,1):100,0,300);let o="MIXED",c="text-muted";return i>150?(o="INST",c="text-info fw-bold"):i>100?(o="INST+",c="text-info"):i<60?(o="RETAIL",c="text-warning"):i<80&&(o="RETAIL+",c="text-warning"),{value:i,normalized:r(i,0,200),type:o,className:c}}function w(e){const t=e&&(e.analytics||e._analytics)?e.analytics||e._analytics:e||{};let a=0;return a+=1*((n(t.volDurability2h_percent)||50)-50),a+=.5*((n(t.freqRatio2h_percent)||50)-50),a+=30*(n(t.volImbalance2h)||0),{value:l(a,-100,100),normalized:r(a,-100,100),direction:a>20?"BUY":a<-20?"SELL":"NEUTRAL",className:a>30?"text-success":a<-30?"text-danger":"text-muted"}}function P(e){const t=e&&(e.analytics||e._analytics)?e.analytics||e._analytics:e||{},a=n(t.volBuy2h)||0,l=n(t.volSell2h)||0,i=n(t.freqBuy2h)||0,r=n(t.freqSell2h)||0,c=a+l,s=i+r,u=c>0?(a-l)/c:0,h=s>0?(i-r)/s:0,m=.7*u+.3*h,d=m>.05?"BUY":m<-.05?"SELL":"NEUTRAL",f=m>.05?"text-success":m<-.05?"text-danger":"text-muted";return{value:m,normalized:o(m,-1,1),interpretation:d,volImbalance:u,freqImbalance:h,className:f}}function U(e,t=50,a=.7){const l=e&&Array.isArray(e._history)?e._history:e&&Array.isArray(e.history)?e.history:[];if(!l||0===l.length)return{pocPrice:0,pocBin:0,valueAreaLow:0,valueAreaHigh:0,totalVolume:0,valueAreaPercent:0};const i=l.map(e=>({price:n(e.price)||n(e.last)||n(e.close)||n(e.high)||n(e.low)||0,vol:n(e.vol)||n(e.volume)||n(e.size)||n(e.qty)||n(e.buy)+n(e.sell)||0})).filter(e=>e.price>0&&e.vol>0);if(!i.length)return{pocPrice:0,pocBin:0,valueAreaLow:0,valueAreaHigh:0,totalVolume:0,valueAreaPercent:0};let r=1/0,o=-1/0,c=0;for(const e of i)e.price<r&&(r=e.price),e.price>o&&(o=e.price),c+=e.vol;if(!Number.isFinite(r)||!Number.isFinite(o)||r>=o){const e=i.reduce((e,t)=>e+t.price,0)/i.length;return{pocPrice:e,pocBin:0,valueAreaLow:e,valueAreaHigh:e,totalVolume:c,valueAreaPercent:1}}const s=Math.max(1,Math.floor(t)),u=(o-r)/s,h=new Array(s).fill(0);for(const e of i){let t=Math.floor((e.price-r)/u);t<0&&(t=0),t>=s&&(t=s-1),h[t]+=e.vol}let m=0,d=-1;for(let e=0;e<h.length;e++)h[e]>d&&(d=h[e],m=e);const f=c*Math.max(.01,Math.min(.99,a));let v=m,y=m,M=h[m];for(;M<f;){const e=v-1>=0?h[v-1]:-1,t=y+1<h.length?h[y+1]:-1;if(e<=0&&t<=0)break;t>e?(y++,M+=h[y]):(v--,M+=h[v])}const p=r+(m+.5)*u,N=r+v*u,g=r+(y+1)*u,b=c>0?M/c:0;return{pocBin:m,pocPrice:Number.isFinite(p)?p:0,valueAreaLow:Number.isFinite(N)?N:0,valueAreaHigh:Number.isFinite(g)?g:0,totalVolume:c,valueAreaPercent:b,buckets:h,binWidth:u,minPrice:r,maxPrice:o}}function F(e){const t=e&&(e.analytics||e._analytics)?e.analytics||e._analytics:{},a=Array.isArray(e&&e._history)?e._history:Array.isArray(e&&e.history)?e.history:[],l=a.length?a[a.length-1]:null,i=e=>{if(!e)return{buy:0,sell:0,total:0};const t=n(e.buy)||n(e.volBuy)||n(e.vol_buy)||n(e.volBuy2h)||0,a=n(e.sell)||n(e.volSell)||n(e.vol_sell)||n(e.volSell2h)||0;return{buy:t,sell:a,total:t+a}},r=Math.min(10,Math.max(3,Math.floor(a.length/6))),o=a.slice(Math.max(0,a.length-r),a.length-1);let c=0,s=0,u=0;for(const e of o){const t=i(e);c+=t.buy,s+=t.sell,u++}const h=u>0?c/u:n(t.avgBuy2h)||1,m=u>0?s/u:n(t.avgSell2h)||1,d=i(l),f=h>0?d.buy/h:0,v=m>0?d.sell/m:0,y=n(l&&(l.price||l.last||l.close))||n(e.last)||0,M=n(a.length>=2?a[a.length-2].price||a[a.length-2].last:null)||0,p=M>0&&y>0?(y-M)/M*100:0;let N="NONE",g=0;f>=3&&p>=.3?(N="BUY",g=Math.min(100,Math.round((f-3)/3*50+Math.min(50,10*p)))):v>=3&&p<=-.3&&(N="SELL",g=Math.min(100,Math.round((v-3)/3*50+Math.min(50,10*Math.abs(p)))));const b=Math.max(1,h+m),A=Math.max(1,d.total)/b;return A>5&&g<30&&(g=Math.min(100,g+Math.round(5*(A-5))),d.buy>d.sell?N="BUY":d.sell>d.buy&&(N="SELL")),{sweep:"NONE"!==N&&g>0,side:N,confidence:g,buyRatio:Number.isFinite(f)?f:0,sellRatio:Number.isFinite(v)?v:0,pricePct:Number.isFinite(p)?p:0,totalSpikeRatio:Number.isFinite(A)?A:0}}function V(e){const t=e&&(e.analytics||e._analytics)?e.analytics||e._analytics:e||{},a=n(t.volDurability2h_percent)||50,i=n(t.volDurability24h_percent)||50,r=D(e),o=1-Math.abs((a-50)/50-(i-50)/50),c=100*(.5*(Math.abs(a-50)/50)+.3*o+.2*(r.normalized/100)),s=a>55?"UP":a<45?"DOWN":"SIDEWAYS";return{value:l(c,0,100),normalized:l(c,0,100),direction:s,level:c>70?"STRONG":c>40?"MODERATE":"WEAK",className:c>60?"text-success":c>30?"text-warning":"text-muted"}}function z(e){const t=e&&(e.analytics||e._analytics)?e.analytics||e._analytics:e||{},i=e._history||[],o=l(100-20*(100*a(m(i,14),i.length>0?i.slice(-14).reduce((e,t)=>e+n(t.last),0)/Math.min(i.length,14):n(e.last),.05)),0,100),c=D(e).normalized,s=r(Math.abs(n(t.volImbalance2h)||0),0,.5),u=n(t.pricePosition)||50,h=r(Math.max(u,100-u),50,100),d=.3*o+.25*c+.25*s+.2*h,f=d>70?"HIGH":d>50?"MEDIUM":"LOW";return{value:l(d,0,100),normalized:l(d,0,100),level:f,confidence:f,direction:u>60?"UP":u<40?"DOWN":"UNKNOWN",className:d>70?"text-warning fw-bold":d>50?"text-warning":"text-muted",factors:{compression:o,intensity:c,imbalance:s,extreme:h}}}function W(e){const t=e&&(e.analytics||e._analytics)?e.analytics||e._analytics:e||{},a=n(t.liquidity_avg_trade_value)||0;n(e.total_vol_fiat)||n(t.totalVolFiat);const i=(n(t.freqBuy2h)||0)+(n(t.freqSell2h)||0);let o=50;if(a>0){const e=1e3;o=r(a,.1*e,10*e)}return i>0&&i<100&&(o+=.2*(100-i)),o=l(o,0,100),{value:o,normalized:o,level:o>70?"ILLIQUID":o>40?"MODERATE":"LIQUID",className:o>70?"text-danger":o>40?"text-warning":"text-success",avgTradeValue:a}}function H(e){const t=e&&(e.analytics||e._analytics)?e.analytics||e._analytics:e||{},i=e._history||[],r=100*a(m(i,14),i.length>0?i.slice(-14).reduce((e,t)=>e+n(t.last),0)/Math.min(i.length,14):n(e.last),.02),o=n(t.volDurability2h_percent)||50,c=n(t.pricePosition)||50,s=r<1.5,u=r>4,h=Math.abs(o-50)>15,d=o>50?"UP":"DOWN";let f="RANGE",v=50;return s&&!h?(f="SQUEEZE",v=70+10*(1.5-r)):u&&h?(f="TREND",v=60+Math.abs(o-50)):h&&c>70?(f="TREND_UP",v=c-70+55):h&&c<30?(f="TREND_DOWN",v=30-c+55):(f="RANGE",v=50-Math.abs(o-50)+50),{mode:f,confidence:l(v,0,100),atrPercent:r,bias:h?d:"NONE",className:f.includes("TREND")?"text-success":"SQUEEZE"===f?"text-warning":"text-muted"}}function C(e){const t=e&&(e.analytics||e._analytics)?e.analytics||e._analytics:e||{},i=Array.isArray(e&&e._history)?e._history:Array.isArray(e&&e.history)?e.history:[],r=m(i,14),o=100*a(r,i.length>0?i.slice(-14).reduce((e,t)=>e+n(t.last),0)/Math.min(i.length,14):n(e.last),0),c=n(t.volDurability2h_percent)||50,s=n(t.volDurability24h_percent)||50;let u="UNKNOWN",h=30;const d=o<1.5,f=o>4,v=c-s;if(d&&v>5)u="ACCUMULATION",h=50+Math.min(50,2*v+10*(1.5-o));else if(f&&v<-5)u="DISTRIBUTION",h=50+Math.min(50,2*Math.abs(v)+5*(o-4));else if(f&&Math.abs(v)>8)u=v>0?"TREND_UP":"TREND_DOWN",h=50+Math.min(50,2*Math.abs(v)+5*(o-4));else if(d&&Math.abs(v)<=5)u="RANGE",h=40+Math.min(40,10*(1.5-o));else{const e=m(i.slice(-6),6)||0;(e>r?1:e<r?-1:0)>0&&Math.abs(v)>3?(u=v>0?"EMERGING_UP":"EMERGING_DOWN",h=35+Math.min(50,3*Math.abs(v))):(u="MIXED",h=30)}return{regime:u,confidence:l(Math.round(h),0,100),atrPercent:Number.isFinite(o)?o:0,volDur2h:c,volDur24h:s,volDurDelta:v}}function k(e){const t=L(e),a=w(e);V(e);const n=R(e),l=O(e),i=D(e);let r=0;r+=.8*(t.value-50),r+=.3*a.value,"BULL DIV"===n.interpretation&&(r+=15),"BEAR DIV"===n.interpretation&&(r-=15),l.value>70&&t.value>55&&(r+=10),l.value>70&&t.value<45&&(r-=10),i.value>70&&a.value>20&&(r+=10),i.value>70&&a.value<-20&&(r-=10);let o="HOLD",c="recommendation-hold";const s=Math.min(Math.abs(r),100);return r>25?(o="BUY",c="recommendation-buy"):r<-25&&(o="SELL",c="recommendation-sell"),{signal:o,confidence:Math.round(s),score:Math.round(r),className:c}}function q(e,t=["120m","30m","15m","5m","1m"],a=null){const l=a||{"120m":.3,"30m":.25,"15m":.2,"5m":.15,"1m":.1},i=Array.isArray(e&&e._history)?e._history:Array.isArray(e&&e.history)?e.history:[];let r=50;try{if(e&&e.analytics&&Number.isFinite(Number(e.analytics.pricePosition)))r=Number(e.analytics.pricePosition);else if(i&&i.length){const t=n(i[i.length-1].last)||n(e.last)||0;let a=1/0,l=-1/0;for(let e=Math.max(0,i.length-120);e<i.length;e++){const t=i[e],r=n(t.price)||n(t.last)||n(t.close)||0;r>0&&(r<a&&(a=r),r>l&&(l=r))}Number.isFinite(a)&&Number.isFinite(l)&&l>a&&t>0&&(r=Math.round((t-a)/(l-a)*100))}else if(e&&e.last&&e.high&&e.low){const t=n(e.last),a=n(e.high),l=n(e.low);a>l&&(r=Math.round((t-l)/(a-l)*100))}}catch(e){r=50}const o=[];let c=0,s=0;for(const a of t)try{let n=null;if("function"==typeof calculateRecommendation&&(n=calculateRecommendation(e,r,a,!1)),!n){const t=w(e),a="BUY"===t.direction?1:"SELL"===t.direction?-1:0;n={recommendation:a>0?"BUY":a<0?"SELL":"HOLD",confidence:Math.min(100,Math.round(Math.abs(t.value)))}}const i=Math.max(0,Math.min(100,Number(n.confidence)||0)),u="BUY"===n.recommendation?1:"SELL"===n.recommendation?-1:0,h=l&&l[a]?l[a]:1/t.length,m=u*(i/100)*h;c+=m,s+=h,o.push({timeframe:a,rec:n.recommendation||"HOLD",confidence:i,weight:h,contrib:m})}catch(e){o.push({timeframe:a,rec:"HOLD",confidence:0,weight:l&&l[a]?l[a]:1/t.length,contrib:0})}const u=s>0?c/s:0;return{consensus:u>.25?"BUY":u<-.25?"SELL":"MIXED",score:u,confluence:Math.round(100*Math.abs(u)),breakdown:o}}function G(e){return{ofi:P(e),volumeProfile:U(e,50,.7),liquiditySweep:F(e),regimeTransition:C(e),multiTfConfluence:q(e),smi:T(e),intensity:D(e),divergence:R(e),accumScore:L(e),whale:O(e),riRatio:B(e),pressure:w(e),trendStrength:V(e),breakout:z(e),lsi:W(e),marketMode:H(e),smartSignal:k(e)}}t.SCALES,t.THRESHOLDS,t.DEFAULTS;const Y={safeDiv:a,toNum:n,clamp:l,normalizeMetric:i,mapTo0_100:r,mapToNeg100_100:o,meanStd:c,zScore:s,safeZScore:u,percentile:h,computeATR:m,calculateVolRatio:d,calculateVolDurability:f,calculateSmartMoneyIndex:T,calculateTradeIntensity:D,calculateMomentumDivergence:R,calculateAccumulationScore:L,calculateWhaleActivity:O,calculateRetailInstitutionalRatio:B,calculatePressureIndex:w,calculateTrendStrength:V,generateSmartSignal:k,calculateOrderFlowImbalance:P,calculateVolumeProfile:U,detectLiquiditySweep:F,calculateBreakoutProbability:z,calculateLiquidityStressIndex:W,classifyMarketMode:H,detectRegimeTransition:C,computeAllSmartMetrics:G,computeKyleLambda:v,computeVWAPBands:y,computeCVD:M,computeRVOL:p,normalizeKyleLambda:N,normalizeVWAP:g,normalizeCVD:b,normalizeRVOL:A,computeTier1Normalized:I,computeVPIN:E,computeHurstExponent:_,computeVolumeProfilePOC:S,computeDepthImbalance:x};return e.AnalyticsCore=Y,e.calculateAccumulationScore=L,e.calculateBreakoutProbability=z,e.calculateLiquidityStressIndex=W,e.calculateMomentumDivergence=R,e.calculateOrderFlowImbalance=P,e.calculatePressureIndex=w,e.calculateRetailInstitutionalRatio=B,e.calculateSmartMoneyIndex=T,e.calculateTradeIntensity=D,e.calculateTrendStrength=V,e.calculateVolDurability=f,e.calculateVolRatio=d,e.calculateVolumeProfile=U,e.calculateWhaleActivity=O,e.clamp=l,e.classifyMarketMode=H,e.computeATR=m,e.computeAllSmartMetrics=G,e.computeCVD=M,e.computeDepthImbalance=x,e.computeHurstExponent=_,e.computeKyleLambda=v,e.computeRVOL=p,e.computeTier1Normalized=I,e.computeVPIN=E,e.computeVWAPBands=y,e.computeVolumeProfilePOC=S,e.default=Y,e.detectLiquiditySweep=F,e.detectRegimeTransition=C,e.generateSmartSignal=k,e.mapTo0_100=r,e.mapToNeg100_100=o,e.meanStd=c,e.normalizeCVD=b,e.normalizeKyleLambda=N,e.normalizeMetric=i,e.normalizeRVOL=A,e.normalizeVWAP=g,e.percentile=h,e.safeDiv=a,e.safeZScore=u,e.toNum=n,e.zScore=s,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=analytics-core.umd.js.map
